<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="using:Scada.Client.ViewModels"
        xmlns:system="clr-namespace:System;assembly=System.Runtime"
        mc:Ignorable="d" d:DesignWidth="1100" d:DesignHeight="600"
        x:Class="Scada.Client.Views.TagsEditorWindow"
        x:DataType="vm:TagsEditorWindowViewModel"
        Title="Ð ÐµÐ´Ð°ÐºÑ‚Ð¾Ñ€ Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… Ñ‚ÐµÐ³Ð¾Ð²"
        Width="1100" Height="600"
        WindowStartupLocation="CenterOwner">
    
    <Grid ColumnDefinitions="2*,20,3*" RowDefinitions="Auto,*,Auto" Margin="20">
        
        <!-- Ð›ÐµÐ²Ð°Ñ Ð¿Ð°Ð½ÐµÐ»ÑŒ: ÐŸÐ¾Ð¸ÑÐº Ð¸ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ðµ Ñ‚ÑÐ³Ð¸ -->
        <StackPanel Grid.Column="0" Grid.Row="0" Spacing="10">
            <TextBlock Text="ÐŸÐ¾Ð¸ÑÐº Ñ‚ÐµÐ³Ð¾Ð² (Ð¸Ð· tags.json)" FontWeight="Bold" FontSize="14"/>
            <Grid ColumnDefinitions="*,Auto">
                <TextBox Grid.Column="0" Text="{Binding SearchText}" Watermark="Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð¸Ð¼Ñ Ð¸Ð»Ð¸ Ð°Ð´Ñ€ÐµÑ Ñ‚ÐµÐ³Ð°..." />
                <Button Grid.Column="1" Content="ðŸ”" Command="{Binding SearchTagsCommand}" 
                        Padding="10,5" Margin="5,0,0,0" ToolTip.Tip="ÐŸÐ¾Ð¸ÑÐº"/>
            </Grid>
            
            <TextBlock Text="Ð‘Ñ‹ÑÑ‚Ñ€Ð¾Ðµ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½Ð°" FontWeight="SemiBold" FontSize="12" Margin="0,10,0,0"/>
            <Grid ColumnDefinitions="*,Auto">
                <TextBox Grid.Column="0" Text="{Binding RangeText}" Watermark="ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: Y0-Y50, M100-M200" />
                <Button Grid.Column="1" Content="âž•" Command="{Binding AddRangeCommand}" 
                        Padding="10,5" Margin="5,0,0,0" ToolTip.Tip="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½"/>
            </Grid>
        </StackPanel>
        
        <DataGrid Grid.Column="0" Grid.Row="1"
                  ItemsSource="{Binding AvailableTags}"
                  SelectedItem="{Binding SelectedAvailableTag}"
                  AutoGenerateColumns="False"
                  CanUserReorderColumns="False"
                  CanUserResizeColumns="True"
                  CanUserSortColumns="True"
                  GridLinesVisibility="All"
                  BorderThickness="1"
                  BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                  Margin="0,10,0,0">
            <DataGrid.Columns>
                <DataGridTextColumn Header="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ" Binding="{Binding Name}" Width="120" IsReadOnly="True"/>
                <DataGridTextColumn Header="ÐÐ´Ñ€ÐµÑ" Binding="{Binding Address}" Width="80" IsReadOnly="True"/>
                <DataGridTextColumn Header="Ð¢Ð¸Ð¿ Ñ€ÐµÐ³." Binding="{Binding Register}" Width="80" IsReadOnly="True"/>
                <DataGridTextColumn Header="Ð¢Ð¸Ð¿ Ð´Ð°Ð½." Binding="{Binding Type}" Width="80" IsReadOnly="True"/>
            </DataGrid.Columns>
        </DataGrid>

        <StackPanel Grid.Column="0" Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,10,0,0">
            <Button Content="âž¡ï¸ Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð² Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ" Command="{Binding AddTagCommand}" Padding="15,5"/>
        </StackPanel>

        <!-- Ð Ð°Ð·Ð´ÐµÐ»Ð¸Ñ‚ÐµÐ»ÑŒ -->
        <Border Grid.Column="1" Grid.Row="0" Grid.RowSpan="3" 
                Background="{DynamicResource CardStrokeColorDefaultBrush}" Width="2"/>

        <!-- ÐŸÑ€Ð°Ð²Ð°Ñ Ð¿Ð°Ð½ÐµÐ»ÑŒ: ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ Ñ‚ÑÐ³Ð¸ (Ð¾Ð¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÐµÐ¼Ñ‹Ðµ) -->
        <StackPanel Grid.Column="2" Grid.Row="0" Spacing="5">
            <TextBlock Text="ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ Ñ‚ÐµÐ³Ð¸ (Ð±ÑƒÐ´ÑƒÑ‚ Ð¾Ð¿Ñ€Ð°ÑˆÐ¸Ð²Ð°Ñ‚ÑŒÑÑ)" 
                       FontWeight="Bold" FontSize="14"/>
            <TextBlock Text="ðŸ’¡ Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ctrl+Click Ð¸Ð»Ð¸ Shift+Click Ð´Ð»Ñ Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð²Ñ‹Ð´ÐµÐ»ÐµÐ½Ð¸Ñ" 
                       FontSize="11" Foreground="Gray" Margin="0,0,0,5"/>
        </StackPanel>
        
        <DataGrid Grid.Column="2" Grid.Row="1"
                  Name="ActiveTagsDataGrid"
                  ItemsSource="{Binding ActiveTags}"
                  SelectedItem="{Binding SelectedActiveTag}"
                  SelectionMode="Extended"
                  AutoGenerateColumns="False"
                  CanUserReorderColumns="True"
                  CanUserResizeColumns="True"
                  CanUserSortColumns="True"
                  GridLinesVisibility="All"
                  BorderThickness="1"
                  BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}">
            <DataGrid.Columns>
                <DataGridTextColumn Header="ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ" Binding="{Binding Name}" Width="120" IsReadOnly="True"/>
                <DataGridTextColumn Header="ÐÐ´Ñ€ÐµÑ" Binding="{Binding Address}" Width="80" IsReadOnly="True"/>
                <DataGridTextColumn Header="Ð¢Ð¸Ð¿ Ñ€ÐµÐ³." Binding="{Binding Register}" Width="100" IsReadOnly="True"/>
                <DataGridTemplateColumn Header="Ð¢Ð¸Ð¿ Ð´Ð°Ð½." Width="100">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Type}" VerticalAlignment="Center" Margin="5,0"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                    <DataGridTemplateColumn.CellEditingTemplate>
                        <DataTemplate>
                            <ComboBox ItemsSource="{Binding AllowedDataTypes}" 
                                      SelectedItem="{Binding Type, Mode=TwoWay}"
                                      HorizontalAlignment="Stretch"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellEditingTemplate>
                </DataGridTemplateColumn>
                <DataGridTextColumn Header="ÐœÐ°ÑÑˆÑ‚Ð°Ð±" Binding="{Binding Scale}" Width="80"/>
                <DataGridTextColumn Header="Ð¡Ð¼ÐµÑ‰ÐµÐ½Ð¸Ðµ" Binding="{Binding Offset}" Width="80"/>
                <DataGridCheckBoxColumn Header="Ð’ÐºÐ»ÑŽÑ‡ÐµÐ½" Binding="{Binding Enabled}" Width="80"/>
            </DataGrid.Columns>
        </DataGrid>

        <!-- ÐšÐ½Ð¾Ð¿ÐºÐ¸ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ -->
        <StackPanel Grid.Column="2" Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0" Spacing="10">
            <Button Content="ðŸ—‘ï¸ Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð²ÑÐµ" Command="{Binding DeleteAllTagsCommand}" Padding="15,5" ToolTip.Tip="Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð²ÑÐµ Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ Ñ‚ÑÐ³Ð¸"/>
            <Button Content="âŒ Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ðµ" Command="{Binding DeleteTagCommand}" Padding="15,5" ToolTip.Tip="Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ðµ Ñ‚ÑÐ³Ð¸ (Ð¼Ð¾Ð¶Ð½Ð¾ Ð²Ñ‹Ð´ÐµÐ»Ð¸Ñ‚ÑŒ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾)"/>
            <Button Content="ðŸ’¾ Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ" Click="OnSaveClick" Padding="15,5"/>
            <Button Content="ÐžÑ‚Ð¼ÐµÐ½Ð°" Click="OnCancelClick" Padding="15,5"/>
        </StackPanel>
    </Grid>
</Window>
