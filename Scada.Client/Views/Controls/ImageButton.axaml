<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:controls="using:Scada.Client.Views.Controls"
             x:Class="Scada.Client.Views.Controls.ImageButton"
             Width="140" Height="140">
  <Border x:Name="Root" 
          CornerRadius="8" 
          Padding="12" 
          Background="{DynamicResource ControlFillColorDefaultBrush}" 
          BorderBrush="{DynamicResource ControlStrokeColorDefaultBrush}" 
          BorderThickness="1">
    <StackPanel Spacing="10" HorizontalAlignment="Center">
      <TextBlock Text="{Binding Label, RelativeSource={RelativeSource AncestorType=controls:ImageButton}}"
                 FontWeight="Bold" HorizontalAlignment="Center" FontSize="13"/>
      
      <!-- Графическое представление -->
      <Viewbox Width="70" Height="60">
        <Canvas Width="100" Height="80">
          <!-- Выбор типа изображения -->
          <ContentControl>
            <ContentControl.Content>
              <Binding Path="ImageType" RelativeSource="{RelativeSource AncestorType=controls:ImageButton}">
                <Binding.Converter>
                  <controls:ImageTypeToShapeConverter/>
                </Binding.Converter>
              </Binding>
            </ContentControl.Content>
          </ContentControl>
        </Canvas>
      </Viewbox>
      
      <!-- Индикатор состояния -->
      <Border Height="25" CornerRadius="4" Padding="8,4">
        <Border.Background>
          <Binding Path="IsActive" RelativeSource="{RelativeSource AncestorType=controls:ImageButton}">
            <Binding.Converter>
              <controls:ActiveStateBackgroundConverter/>
            </Binding.Converter>
          </Binding>
        </Border.Background>
        <TextBlock FontSize="11" FontWeight="SemiBold" HorizontalAlignment="Center">
          <TextBlock.Text>
            <Binding Path="IsActive" RelativeSource="{RelativeSource AncestorType=controls:ImageButton}">
              <Binding.Converter>
                <controls:ActiveStateTextConverter/>
              </Binding.Converter>
            </Binding>
          </TextBlock.Text>
          <TextBlock.Foreground>White</TextBlock.Foreground>
        </TextBlock>
      </Border>

      <!-- Кнопки управления -->
      <Grid ColumnDefinitions="*,*" ColumnSpacing="6">
        <Button Grid.Column="0" Content="ВКЛ" FontSize="10" Padding="10,5"
                Command="{Binding OnCommand, RelativeSource={RelativeSource AncestorType=controls:ImageButton}}"
                Classes="accent" FontWeight="Bold"/>
        <Button Grid.Column="1" Content="ВЫКЛ" FontSize="10" Padding="10,5"
                Command="{Binding OffCommand, RelativeSource={RelativeSource AncestorType=controls:ImageButton}}"
                Background="#DC2626" Foreground="White" FontWeight="Bold"/>
      </Grid>
    </StackPanel>
  </Border>
</UserControl>
